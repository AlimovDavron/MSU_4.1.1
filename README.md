Документация.

Данная программа решает задачу поиска собственных чисел методом LR разложения с упрощением методом отражений.

Описание алгоритма:
    Работа программы состоит из двух этапов, в первом принимает на вход симметричную матрицу и приводит её
    к трёхдиагональному виду методом отражений.
    Во втором этапе программа вычисляет собственные числа используя LR метод к трёхдиагональной матрице.
    Также в программе используются методы исчерпывания матрицы и сдвигов для ускорения сходимости LR разложения.

    Подробное описание вышеуказанных алгоритмов можно найти:
    1. Приведение симметричной матрицы к трёхдиагональному виду - [1] 15.2, страница 75
    2. Алгоритм построения LR разложения для трёхдиагональной матрицы - [1] 7.1.3, страница 101
    3. Ускорение сходимости алгоритма 2. - [1] 7.3, страница 104


Компоненты программы:
    1. main_01_03.c
    2. sim_01_03.c
    3. evc_01_03.c

Функции реализованные в файле main_01_03.c:
    int _strlen(char const *input)
        Описание:
            Функция принимает на вход строку и возвращает её длину.
        Аргументы функции:
            Строка
        Возвращаемые значения:
            Целое число - длина строки.

    int validateFile(char* filename)
        Описание:
            Функция принимает на вход путь к файлу в виде строки.
        Аргументы функции:
            Строка
        Возвращаемые значения:
            0 - Такого файла по данному пути не существует.
            1 - Файл по данному пути существует.

    int validateParameters(int argc, char **argv)
        Описание:
            Функция принимает на вход аргументы переданные в консоли и проверяет их на корректность.
        Аргументы:
            Целое число - Количество аргументов .
            Указатель - массив аргументов.
        Возвращаемые значения:
            0 - Валидация флагов прошла успешно и соответствуют условиям.
            1 - Названий файлов больше, чем 2.
            2 - Ошибка ввода параметров. Такого флага не существует или не передано значение параметру.
            3 - Значение параметра количества итераций отрицательное.

    int readInputData(char *inputFile, double** A, double** B, double** X, int *n)
        Описание:
            Функция принимает на вход название файла, указатели на матрицы и размер матрицы.
            Выделяет память для них, проверяет входные данные на корректность.
        Аргументы функции:
            Строка - название файла.
            Указатель - матрица.
            Указатель - размер матрицы.
        Возвращаемые значения:
            0 - Успешно. Функция выделила память, считала нужно количество данных, проверила их на корректность и не выявила ошибок
            6 - Ошибка. Файл входных данных пуст.
            7 - Ошибка. Размер матрицы системы не является положительным целым числом.
            8 - Ошибка. Недостаточно элементов матрицы.
            9 - Ошибка. Один из элементов матрицы не является числом.

    void writeAnswer(char *outputFile, int n, const double* X, int result)
        Описание:
            Функция принимает на вход выходной файл, размер матрицы, указатель на решение и переменную для обозначения существования ответа.
        Аргументы функции:
            Строка - название выходного файла.
            Целое число - размер матрицы.
            Указатель - массив с решением задачи.
            Целое число - параметр (-1, если ответа не существует, иначе - 0, если успешно, 1, если точность не сошлась).
        Возвращаемые значения:
            Нет.

    void printHelp()
        Описание:
            Функция выводит в консоль справочную информацию.
        Аргументы функции:
            Нет.
        Возвращаемые значения:
            Нет.

Функции реализованные в файле sim_01_03.c:
    size_t lss_memsize_01_03(int n)
        Описание:
            Функция принимает на вход размер квадратной матрицы и возвращает количество памяти,
            необходимое алгоритму для решения задачи.
        Аргументы функции:
            Целое число - размер матрицы.
        Возвращаемые значения:.
            Целое неотрицательное число - необходимое количество памяти.

    typedef struct {
        int* n,* m;
        double* matrix;
    }Matrix; - Структура для представления матрицы,
        где *n - указатель на количество строк
        *m - указатель на количество столбцов
        double* matrix - указатель на матрицу

    void printMatrix(Matrix matrix)
        Описание:
            Функция принимает структуру матрица и отображает на экран.
        Аргументы функции:
            Нет.
        Возвращаемые значения:
            Нет.

    void copyMatrix(Matrix original, Matrix target)
         Описание:
            Функция принимает на вход две матрицы и копирует содержимое первой матрицы во вторую.
        Аргументы функции:
            Структура матрица - матрица "оригинал"
            Структура матрица - матрица, куда помещается содержимое "оригинала"
        Возвращаемые значения:
            Нет.

    void multiplyByN(Matrix A, double n)
         Описание:
            Функция принимает на вход матрицу, число и умножает каждый элемент матрицы на число.
        Аргументы функции:
            Структура матрица - матрица
            Число - число на которое умножается каждый элемент матрицы
        Возвращаемые значения:
            Нет.

    double scalarMultiplication(Matrix a, Matrix b)
        Описание:
            Функция принимает на вход два вектора и возвращает их скалярное произведение
        Аргументы функции:
            Структура матрица - вектор. Необходимо, чтобы n > 0 и m = 1
            Структура матрица - вектор, Необходимо, чтобы n > 0 и m = 1 и размерность была равна размерности
                                                                           первой матрицы
        Возвращаемые значения:
            Число - скалярное произведение

    double calculateNorm(Matrix a)
        Описание:
            Функция принимает на вход вектор и возвращает норму вектора
        Аргументы функции:
            Структура матрица - матрица. Необходимо, чтобы n > 0 и m = 0
        Возвращаемые значения:
            Число - норма вектора

    void multiply(Matrix A, Matrix B, Matrix C, double precision)
        Описание:
            Функция принимает на вход три матрицы. Умножает первую матрицу на вторую
            и помещает результат в третью матрицу.
        Аргументы функции:
            Структура матрица - матрица
            Структура матрица - матрица
            Структура матрица - матрица, в которую помещается результат умножения
            Число - точность локализации нуля
        Возвращаемые значения:
            Нет

    void initA1(int iteration, Matrix A, Matrix a1)
        Описание:
            Функция принимает на вход номер столбца, матрицу и вектор и помещает
            вектор под диагональю  i-го столбца матрицы в вектор
        Аргументы функции:
            Число - номер столбца
            Структура матрица - матрица
            Структура матрица - вектор
        Возвращаемые значения:
            Нет

    int initX(Matrix a1, Matrix x, double precision)
        Описание:
            Функция принимает на вход два вектора. Считает значение вектора x согласно описанию
            алгоритма приведения симметричной матрицы к трёхдиагональному виду и помещает его во
            второй вектор
        Аргументы функции:
            Структура матрица - вектор. Необходимо, чтобы n > 0 и m = 1
            Структура матрица - вектор, Необходимо, чтобы n > 0 и m = 1 и размерность была равна размерности первой матрицы
            Число - точность локализации нуля
        Возвращаемые значения:
            1 - в случае успеха
            0 - в случае, если в процессе работы функции была осуществлена попытка разделить на ноль

    void initY(Matrix A, Matrix x, Matrix y, double precision)
        Описание:
            Функция принимает на вход матрицу и два вектора. Считает значение вектора y согласно описанию
            алгоритма приведения симметричной матрицы к трёхдиагональному виду и помещает его в третий вектор
        Аргументы функции:
            Структура матрица - матрица.
            Структура матрица - вектор. Необходимо, чтобы n > 0 и m = 1
            Структура матрица - вектор, Необходимо, чтобы n > 0 и m = 1 и размерность была равна размерности первой матрицы
            Число - точность локализации нуля
        Возвращаемые значения:
            Нет

    void initZ(Matrix x, Matrix y, Matrix z, double precision)
        Описание:
            Функция принимает на вход матрицу и два вектора. Считает значение вектора z согласно описанию
            алгоритма приведения симметричной матрицы к трёхдиагональному виду и помещает его в третий вектор
        Аргументы функции:
            Структура матрица - матрица.
            Структура матрица - вектор. Необходимо, чтобы n > 0 и m = 1
            Структура матрица - вектор, Необходимо, чтобы n > 0 и m = 1 и размерность была равна размерности первой матрицы
            Число - точность локализации нуля
        Возвращаемые значения:
            Нет

    void calculateSubMatrix(Matrix subMatrix, Matrix x, Matrix z, double precision)
            Описание:
                Функция принимает на вход матрицу и два вектора. Вычитает из матрицы попарные произведения
                векторов согласно описанию алгоритма
            Аргументы функции:
                Структура матрица - матрица.
                Структура матрица - вектор. Необходимо, чтобы n > 0 и m = 1
                Структура матрица - вектор, Необходимо, чтобы n > 0 и m = 1 и размерность была равна размерности первой матрицы
                Число - точность локализации нуля
            Возвращаемые значения:
                Нет

    void initSubMatrix(int iteration, Matrix A, Matrix subMatrix)
            Описание:
                Функция принимает на вход две матрицы и номер итерации. Помещеает квадратную подматрицу
                размера n-iteration первой матрицы во вторую
            Аргументы функции:
                Число - номер итерации.
                Структура матрица - матрица.
                Структура матрица - матрица.
            Возвращаемые значения:
                Нет

    void nextStep(int iteration, Matrix target, Matrix a1, Matrix targetSubMatrix)
            Описание:
                Принимает на вход номер итерации, исходную матрицу, матрицу a1 и подматрицу и осуществляет
                следующий шаг алгоритма, а именно - помещает значения подматрицы в исходную матрицу и
                перемещает значения вектора a1 в исходную матрицу под диагональную с номером iteration
            Аргументы функции:
                Число - номер итерации.
                Структура матрица - матрица.
                Структура матрица - матрица.
                Структура матрица - матрица.
            Возвращаемые значения:
                Нет

    int isMatrixSymmetric(Matrix A, double precision)
            Описание:
                Проверяет является ли матрица симметричной
            Аргументы функции:
                Структура матрица - матрица.
                Число - точность локализации нуля.
            Возвращаемые значения:
                1 - матрица симметричная
                0 - матрица не является симметричнй


    int sim_01_03(int n, double* A, double* tmp, double precision)
            Описание:
                Основная часть модуля упрощения, в котором распределяется дополнительная память и осуществляется
                работа алгоритма.
            Возвращаемые значения:
                0 - матрица успешно упрощена и приведена к трёхдиагональному виду
                -1 - исходная матрица не является симметричной

Функции реализованные в файле evc_01_03.c:

    void fillMatrix(double* A, int dim, double value)
            Описание:
                Получает на вход матрицу, значение и заполняет матрицу значением.
            Аргументы функции:
                Указатель - матрица
                Целое число - размерность матрицы
                Число - значение
            Возвращаемые значения:
                Нет

    int LRTransformation(int n, double* A, double* L, double* R, int precision_iteration, double precision)
            Описание:
                Получает на вход указатель на матрицу и помещает L R разложение в соответствующие подматрицы
                по указателям переданным на вход и номеру итерации

            Аргументы функции:
                Число - размерность матрицы
                Указатель - матрица
                Указатель - матрица для L
                Указатель - матрица для R
                Целое число - номер итерации
                Число - локализация нуля
            Возвращаемые значения:
                Нет

    void fastMultiplyForLR(int n, double* R, double* L, double* C, int precision_iteration)
            Описание:
                Получает на вход матрицы R и L и осуществляет эффективное умножение матрицы с асимптотикой
                O(n). Результат умножения помещается в третью матрицу

            Аргументы функции:
                Число - размерность матрицы
                Указатель - матрица R
                Указатель - матрица L
                Указатель - матрица для результата
                Целое число - номер итерации
            Возвращаемые значения:
                Нет

    double getNorm(int n, double* A, int precision_iteration)
            Описание:
                Получает на вход матрицу и возвращает норму подматрицы соответствующей номеру итерации

            Аргументы функции:
                Число - размерность матрицы
                Указатель - матрица
                Число - номер итерации
            Возвращаемые значения:
                Норма матрицы


    int checkPrecisionCondition(int n, double* A, double epsilon, int precision_iteration, double norm)
            Описание:
                Получает на вход матрицу, epsilon, норму и проверяет достигается ли на текущей итерации
                точность epsilon

            Аргументы функции:
                Число - размерность матрицы
                Указатель - матрица
                Число - epsilon
                Число - номер итерации
                Число - норма подматрицы соответствующей итерации
            Возвращаемые значения:
                1 - если точность на данной итерации достигнута
                0 - если точность на данной итерации не достигнута


    void addValueToDiagonal(int n, double *A, double precision_iteration, double value)
            Описание:
                Получает на вход матрицу и прибавляет value к диагональным элементам подматрицы
                соответствующей итерации

            Аргументы функции:
                Число - размерность матрицы
                Указатель - матрица
                Число - номер итерации
                Число - значение
            Возвращаемые значения:
                Нет

    int evc_01_03(int n, int max_iterations, double epsilon, double* A, double* E, double* tmp, double precision)
            Описание:
                Основная функция модуля вычисляющая собственные значения трёхдиагональной матрицы.
                Более подробное описание алгоритма можно найти в разделе Описание

            Возвращаемые значения:
                0 - собственные значения найдены, точность достигнута
                1 - собственные значения найдены, точность epsilon не достигнута
                2 - на одной из итераций алгоритма была осуществлена попытка деления на ноль



Использование программы:
    Usage: evc [input_file_name] [output_file_name] [options]
    Where options include:
     -d                print debug messages [default OFF]
     -e                print errors [default OFF]
     -p                print matrix [default OFF]
     -t                print execution time [default OFF]
     -prec=<num>       precision [default - 1e-14]
     -eps=<num>        epsilon [default - 1e-10]
     -max_iter=<num>   limit number of iterations [default - 0, i.e. not limit]
     -h, -?            print this and exit

Формат входных данных.

        n
        a_1_1 a_1_2 ... a_1_n
        a_2_1 a_2_2 ... a_2_n
        .....................
        a_n_1 a_n_2 ... a_n_n

    Здесь n - размерность матрицы (поле спецификации "%d"), a_i_j - элементы матрицы (поле спецификации "%lf").

Формат выходных данных, если вектор собственных значений найден

        n
        e_1
        e_2
        ...
        e_n

    Здесь n - размерность матрицы (поле спецификации "%d"), e_i - собственные значения, отсортированные в порядке возрастания (поля спецификации "%1.9lf").
    Если метод не применим к входной матрице, выходной файл будет содержать одну единственную цифру 0.


Коды возвращаемых ошибок:
    -1 - Метод поиска собственных значений не применим к данной матрице
    0 - Программа успешно решила задачу. Если ответа не существует, то программа вывела в файл '0', иначе - решение.
    1 - Метод не сходится за указанное число итераций
    2 - Ошибка валидации параметров. Введённого вами параметра не существует.
    3 - Ошибка валидаиии параметров. Недопустимое значение одного из параметров.
    4 - Ошибка валидации параметров. Порядок параметров и названий файлов неверный.
    5 - Ошибка валидации параметров. Файла для входных данных с таким названием не существует.
    6 - Введённый Вами файл для входных данных пуст.
    7 - Размер матрицы системы не является целым положительным числом.
    8 - Количество элементов матрицы меньше необходимого.
    9 - Один из элементов матрицы не является числом.
    10 - Матрица не является симметричной.
    11 - Ошибка валидации параметров. Вы ввели больше двух названий файлов.

Требования к памяти:
    Методу упрощения требуется n*n+5*n+6*sizeof(double) дополнительной памяти
    Вычислительому модулю требуется 3*n*n*sizeof(double) дополнительной памяти

Применимость:
    Метод применим только для симметричных матриц.

Использованная литература:
    [1] К. Ю. Богачёв Практикум на ЭВМ. Методы решения линейных систем и нахождения собственных значений.
    Москва 1998 год.

Алимов Даврон. М2-16.
